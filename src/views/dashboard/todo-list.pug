extends ../blocks/layout

block append styles
    link(rel='stylesheet', type='text/css', href='/styles/dashboard/todo-list.css')

block content
    div
        div.page-content
            include ../blocks/header
            div.inner-content
                div.todo-list
                    if todoItems.length > 0
                        h3 Things to do
                        for item in todoItems
                            div.todo-item
                                div
                                    form(method='POST', action='/check-todo-item')
                                        input(hidden='true', name='id', value=item.id)
                                        input(
                                            type='checkbox',
                                            name='status',
                                            checked=item.checked
                                            hidden='true'
                                        )
                                        label
                                            input(type='submit', hidden='true')
                                            span
                                                img(src='/images/check.svg')
                                    p= item.title
                                div.actions
                                    button
                                        img(src='/images/edit.svg')
                                    form(method='POST', action='/remove-todo-item')
                                        input(hidden='true', name='id', value=item.id)
                                        button
                                            img(src='/images/delete.svg')
                    else
                        p Your list is empty
                div.todo-list-buttons
                    button#add-todo Add
                    button Download

        div(
            class=errorMsg ? 'modal-window visible-modal' : 'modal-window',
            id='add-todo-modal'
        )
            div.modal-content
                h3 What do you need to do?
                form(action='/add-todo-item', method='POST', class='add-todo-form')
                    input(
                        name='title',
                        placeholder='Add a title',
                        class=errorMsg ? 'hasError' : '',
                    )
                    if errorMsg
                        p.inputError= errorMsg
                    div.buttons
                        if errorMsg
                            a(href='/dashboard/todo-list') Cancel
                        else
                            button#cancel-btn  Cancel
                        button(type='submit', class='blue-button') Submit

block append scripts
    script.
        document.addEventListener('DOMContentLoaded', function () {
            const addModal = document.getElementById('add-todo-modal');
            const addBtn = document.getElementById('add-todo');
            const cancelBtn = document.getElementById('cancel-btn');

            addBtn.addEventListener('click', function () {
                const isVisible = addModal.classList.contains('visible-modal');

                if (isVisible) {
                    addModal.classList.remove('visible-modal');

                    return;
                }

                addModal.classList.add('visible-modal');
            })
            cancelBtn.addEventListener('click', function (e) {
            	e.preventDefault();

                addModal.classList.remove('visible-modal');
            })
        });
